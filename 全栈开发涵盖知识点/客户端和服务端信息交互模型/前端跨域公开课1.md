<!--
 * @Author: your name
 * @Date: 2020-09-15 08:18:37
 * @LastEditTime: 2020-09-15 08:49:09
 * @LastEditors: Please set LastEditors
 * @Description: In User Settings Edit
 * @FilePath: \demo\全栈开发涵盖知识点\客户端和服务端信息交互模型\前端跨域公开课1.md
-->

### 跨域（非同源策略请求）

-同源策略请求 ajax/fetch -跨域传输

部署到同一个 web 服务器上:是没有同源策略的

- xampp 修改本地的 host 文件
  127.0.0.1：1234 http://api.qq.com/

服务器拆分：(出现跨域)
web 服务器：静态资源 kbs.sports.qq.com
data 服务器：业务逻辑和数据分析 api.sports.qq.com
图片服务器：

区分同源和跨域:
**三者都一样就是同源，只要有一个不同的就是跨域**

- 协议
- 域名
- 端口号

WEB 服务器地址：http://127.0.0.1:3000/index.html
数据接口地址：http://127.0.0.1:4000/list //这就属于跨域

<!-- =======================跨域解决方案==================================== -->

**1.JSONP**
-script
-img
link
-iframe
-...
=>不存在跨域请求限制

JSONP 的原理：需要基于 script 动态创建来完成（Jquery 里面给我们提供了 JSONP 的处理方式）

```
$.ajax({
  url:'http://127.0.0.1:8001/list',
  method:'get',
  dataType:'jsonp' // => 执行的是JSONP的请求
  success:res=>{
      console.log(res);
  }
});
```

存在问题：JSONP 只能处理 get 请求，安全性也不是特别好，服务器返回木马程序，浏览器也会执行，所以才会有新的方案

================================================

**2.CORS 跨域资源共享**

- 1.客户端（发送 ajax/fetch 请求）
- 2.服务器设置相关的头信息（需要处理 options 试探性处理）
- 存在问题："Access-Control-Allow-Origin"源：设置成\*, 就不允许携带 cookie 了（浏览器为了保证它的安全）

=================================================

**3.http proxy**
一般配置 webpack webpack-dev-server

```
devServer:{
proxy:{
  '/':{
    target:'http://127.0.0.1:3001', //使用的时候直接用接口名称就好
    changeOrigin:true   //设置代理中间件跨域请求
  }
}
}

```

======================================================

**4.ngnix反向代理**
不需要前端干啥，都是服务器部署的事情

======================================================

**5.postMessage**
MDN: window.postMessage

=====================================================

**6.socket.io**
webSocket协议跨域**
实时聊天通讯

====================================================

**7.document.domain + ifram**
只能实现同一个主域，不同子域之间的操作


====================================================

**8.window.name + ifram**


====================================================

**9.location.hash + ifram**


====================================================
 node中间件代理/xampp 修改本地的 host 文件

